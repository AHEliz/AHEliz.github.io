<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calendario de Votaciones | ARMYPE</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f6f6fb;
  padding: 30px;
}

/* CONTENEDOR GENERAL */
.calendario-layout {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 30px;
}

/* ---------- CALENDARIO ---------- */

.calendario {
  background: white;
  padding: 20px;
  border-radius: 12px;
}

.calendario h2 {
  margin-bottom: 15px;
  color: #6a0dad;
}

/* grid 7 columnas */
.grid-calendario {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 10px;
}

.dia,
.fecha {
  padding: 12px;
  text-align: center;
  border-radius: 8px;
}

.dia {
  font-weight: bold;
  background: #ece9f7;
}

/* celdas normales */
.fecha {
  background: #f3f3f9;
  cursor: default;
}

/* fechas con evento */
.fecha.evento {
  background: #6a0dad;
  color: white;
  cursor: pointer;
  position: relative;
}

/* tooltip */
.fecha.evento .tooltip {
  display: none;
  position: absolute;
  bottom: 110%;
  left: 50%;
  transform: translateX(-50%);
  background: #222;
  color: white;
  padding: 8px 10px;
  font-size: 0.8rem;
  border-radius: 6px;
  width: 160px;
  z-index: 10;
}

.fecha.evento:hover .tooltip {
  display: block;
}

/* ---------- URGENCIAS ---------- */

.urgencias {
  background: white;
  padding: 20px;
  border-radius: 12px;
}

.urgencias h3 {
  color: #c2185b;
  margin-bottom: 15px;
}

.urgencia-card {
  background: #fbe9f2;
  padding: 12px;
  border-radius: 10px;
  margin-bottom: 12px;
}

.urgencia-card a {
  text-decoration: none;
  color: #000;
  font-weight: bold;
}

.urgencia-card span {
  display: block;
  font-size: 0.85rem;
  color: #555;
}

/* RESPONSIVE */
@media (max-width: 900px) {
  .calendario-layout {
    grid-template-columns: 1fr;
  }
}
</style>
</head>

<body>

  <!-- T√çTULO DE LA SECCI√ìN -->
  <h1>Calendario de votaciones</h1>
  <p>Fechas importantes y vencimientos üíú</p>

  <!-- ESTRUCTURA DEL CALENDARIO -->
  <div class="calendario-layout">

    <!-- CALENDARIO -->
    <div class="calendario">
      <h2>Enero 2026</h2>
    <div class="grid-calendario" id="calendario"></div>
      <div>

    <!-- BLOQUE DE URGENTES -->
    <div class="urgencias">
      <h3>‚ö†Ô∏è Pr√≥ximos a vencer</h3>
      <div id="lista-urgentes"></div>
    </div>

  </div>

  <!-- SCRIPTS (SIEMPRE AL FINAL DEL BODY) -->
  <script src="../data/votaciones.js"></script>
  <script src="calendario.js"></script>

<script src="../data/votaciones.js"></script>

<script>
const calendario = document.getElementById("calendario");
const hoy = new Date();

const a√±o = hoy.getFullYear();
const mes = hoy.getMonth();

// Primer d√≠a del mes (0 = domingo)
const primerDia = new Date(a√±o, mes, 1).getDay();
const diasMes = new Date(a√±o, mes + 1, 0).getDate();

// Espacios vac√≠os antes del d√≠a 1
for (let i = 0; i < primerDia; i++) {
  calendario.innerHTML += `<div></div>`;
}

// Crear d√≠as
for (let dia = 1; dia <= diasMes; dia++) {
  const fechaActual = new Date(a√±o, mes, dia);
  const fechaISO = fechaActual.toISOString().split("T")[0];

  const eventos = votaciones.filter(v => v.fin === fechaISO);

  let tooltipHTML = "";

  eventos.forEach(e => {
    const diff = Math.ceil((new Date(e.fin) - hoy) / (1000*60*60*24));
    const estado = diff <= 3 ? "‚è∞ Por vencer" : "üü¢ Activa";

    tooltipHTML += `
      <strong>${e.plataforma}</strong><br>
      ${estado}<br>
      ${e.descripcion}<br><br>
    `;
  });

  calendario.innerHTML += `
    <a href="../voting/index.html"
       class="fecha ${eventos.length ? "evento" : ""}">
      ${dia}
      ${eventos.length ? `<div class="tooltip">${tooltipHTML}</div>` : ""}
    </a>
  `;
}
</script>

<script>
const listaUrgentes = document.getElementById("lista-urgentes");

const hoyFecha = new Date();

// filtrar votaciones que vencen en ‚â§ 3 d√≠as
const urgentes = votaciones
  .map(v => {
    const fin = new Date(v.fin);
    const diff = Math.ceil((fin - hoyFecha) / (1000*60*60*24));
    return { ...v, diff };
  })
  .filter(v => v.diff >= 0 && v.diff <= 3)
  .sort((a, b) => a.diff - b.diff)
  .slice(0, 3); // m√°ximo 3 bloques

urgentes.forEach(v => {
  const card = document.createElement("div");
  card.className = "urgencia-card";

  card.innerHTML = `
    <a href="../voting/index.html">
      ${v.plataforma}
      <span>Vence en ${v.diff} d√≠a${v.diff !== 1 ? "s" : ""}</span>
      <span>${v.descripcion}</span>
    </a>
  `;

  listaUrgentes.appendChild(card);
});
</script>


  
</body>

</html>
